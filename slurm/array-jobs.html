



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Array Jobs with Slurm - HPC Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/unibe.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#array-jobs-with-slurm" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="HPC Documentation" aria-label="HPC Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              HPC Documentation
            </span>
            <span class="md-header-nav__topic">
              
                Array Jobs with Slurm
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/hpc-unibe-ch/hpc-docs" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hpc-unibe-ch/hpc-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="HPC Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    HPC Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/hpc-unibe-ch/hpc-docs" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hpc-unibe-ch/hpc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../HOME_migration.html" title="IMPORTANT..Home Migration" class="md-nav__link">
      IMPORTANT..Home Migration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview_workspaces.html" title="PLAN..Workspaces" class="md-nav__link">
      PLAN..Workspaces
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quick-start.html" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../code-of-conduct.html" title="Code of Conduct" class="md-nav__link">
      Code of Conduct
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-Started/ubelix-overview.html" title="UniBE HPC system "UBELIX"" class="md-nav__link">
      UniBE HPC system "UBELIX"
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-Started/account.html" title="Accounts and Activation" class="md-nav__link">
      Accounts and Activation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-Started/login-ssh.html" title="Accessing the HPCs" class="md-nav__link">
      Accessing the HPCs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-Started/workspaces.html" title="Workspaces" class="md-nav__link">
      Workspaces
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-Started/ssh-customization.html" title="SSH customization" class="md-nav__link">
      SSH customization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Workspaces
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Workspaces
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hpc-workspaces/workspaces.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hpc-workspaces/management.html" title="Workspace management" class="md-nav__link">
      Workspace management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hpc-workspaces/environment.html" title="Software environment" class="md-nav__link">
      Software environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hpc-workspaces/monitoring.html" title="Monitoring" class="md-nav__link">
      Monitoring
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Job handling
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Job handling
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="submission.html" title="Submitting jobs" class="md-nav__link">
      Submitting jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="monitoring-jobs.html" title="Monitoring Jobs" class="md-nav__link">
      Monitoring Jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="deleting-jobs.html" title="Deleting Jobs" class="md-nav__link">
      Deleting Jobs
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Array Jobs with Slurm
      </label>
    
    <a href="array-jobs.html" title="Array Jobs with Slurm" class="md-nav__link md-nav__link--active">
      Array Jobs with Slurm
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-an-array" class="md-nav__link">
    Submitting an Array
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limit-the-number-of-concurrently-running-tasks" class="md-nav__link">
    Limit the Number of Concurrently Running Tasks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#canceling-individual-tasks" class="md-nav__link">
    Canceling Individual Tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-case-1-1000-computations-same-resource-requirements-different-inputoutput-arguments" class="md-nav__link">
    Use case 1: 1000 computations, same resource requirements, different input/output arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case-2-read-arguments-from-file" class="md-nav__link">
    Use case 2: Read arguments from file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="gpus.html" title="GPUs" class="md-nav__link">
      GPUs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="interactive-jobs.html" title="Interactive Jobs" class="md-nav__link">
      Interactive Jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="investigating-job-failure.html" title="Investigating a Job Failure" class="md-nav__link">
      Investigating a Job Failure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="checkpointing.html" title="Checkpointing" class="md-nav__link">
      Checkpointing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="fair-share.html" title="Fair Share" class="md-nav__link">
      Fair Share
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Software
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Software
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../software/hpc-modules.html" title="HPC software environment" class="md-nav__link">
      HPC software environment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/pre-installed-software.html" title="Pre-Installed Software" class="md-nav__link">
      Pre-Installed Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/installing-custom-software.html" title="Installing Custom Software" class="md-nav__link">
      Installing Custom Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/EasyBuild.html" title="EasyBuild" class="md-nav__link">
      EasyBuild
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-5" type="checkbox" id="nav-7-5">
    
    <label class="md-nav__link" for="nav-7-5">
      Supported Applications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-5">
        Supported Applications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../software/terminal-multiplexer-tmux.html" title="Terminal Multiplexer (tmux)" class="md-nav__link">
      Terminal Multiplexer (tmux)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/CUDA.html" title="CUDA" class="md-nav__link">
      CUDA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/matlab.html" title="Matlab" class="md-nav__link">
      Matlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/python.html" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/JupyterLab.html" title="JupyterLab" class="md-nav__link">
      JupyterLab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/r.html" title="R" class="md-nav__link">
      R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/relion.html" title="Relion" class="md-nav__link">
      Relion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software/singularity.html" title="Singularity" class="md-nav__link">
      Singularity
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Storage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Storage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../file-system/filesystem-overview.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../file-system/quota.html" title="File System Quota" class="md-nav__link">
      File System Quota
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../file-system/file-transfer.html" title="Moving files to and from the HPCs" class="md-nav__link">
      Moving files to and from the HPCs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../code-of-conduct.html" title="Code of Conduct" class="md-nav__link">
      Code of Conduct
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../general/faq.html" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../halloffame.html" title="Hall of Fame" class="md-nav__link">
      Hall of Fame
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-an-array" class="md-nav__link">
    Submitting an Array
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limit-the-number-of-concurrently-running-tasks" class="md-nav__link">
    Limit the Number of Concurrently Running Tasks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#canceling-individual-tasks" class="md-nav__link">
    Canceling Individual Tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-case-1-1000-computations-same-resource-requirements-different-inputoutput-arguments" class="md-nav__link">
    Use case 1: 1000 computations, same resource requirements, different input/output arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case-2-read-arguments-from-file" class="md-nav__link">
    Use case 2: Read arguments from file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="array-jobs-with-slurm">Array Jobs with Slurm</h1>
<h2 id="description">Description</h2>
<p>You want to submit multiple jobs that are identical or differ only in some arguments. Instead of submitting N jobs independently, you can submit one array job unifying N tasks.</p>
<h2 id="submitting-an-array">Submitting an Array</h2>
<p>To submit an array job, specify the number of tasks as a range of task ids using the &ndash;array option:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#SBATCH --array=n[,k[,...]][-m[:s]]</span>
</code></pre></div>

<p>The task id range specified in the option argument may be a single number, a simple range of the form n-m, a range with a step size s, a comma separated list of values, or a combination thereof. The task ids will be exported to the job tasks via the environment variable SLURM_ARRAY_TASK_ID. Other variables available in the context of the job describing the task range are: SLURM_ARRAY_TASK_MAX, SLURM_ARRAY_TASK_MIN, SLURM_ARRAY_TASK_STEP.</p>
<div class="admonition types danger">
<p>Specifying &ndash;array=10 will not submit an array job with 10 tasks, but an array job with a single task with task id 10. To run an array job with multiple tasks you must specify a range or a comma separated list of task ids.</p>
</div>
<h3 id="limit-the-number-of-concurrently-running-tasks">Limit the Number of Concurrently Running Tasks</h3>
<p>You may want to limit the number of concurrently running tasks if the tasks are very resource demanding and too many of them running concurrently would lower the overall performance of the cluster. To limit the number of tasks that are allowed to run concurrently, use a &ldquo;%&rdquo; separator:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">#SBATCH --array=n[,k[,...]][-m[:s]]%&lt;max_tasks&gt;</span>
</code></pre></div>

<h2 id="canceling-individual-tasks">Canceling Individual Tasks</h2>
<p>You can cancel individual tasks of an array job by indicating tasks ids to the scancel command:</p>
<div class="codehilite"><pre><span></span><code>$ squeue
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="o">(</span>REASON<span class="o">)</span>
79265_<span class="o">[</span><span class="m">49</span>-99:2%20<span class="o">]</span>      <span class="nb">test</span> Simple H  foo      PD      <span class="m">0</span>:00      <span class="m">1</span> <span class="o">(</span>QOSMaxCpuPerUserLimit<span class="o">)</span>
          79265_41      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:10      <span class="m">1</span> fnode03
          79265_43      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:10      <span class="m">1</span> fnode03
          79265_45      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:10      <span class="m">1</span> fnode03
          79265_47      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:10      <span class="m">1</span> fnode03
</code></pre></div>

<p>Use the &ndash;array option to the squeue command to display one tasks per line:</p>
<div class="codehilite"><pre><span></span><code>$ squeue --array
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST<span class="o">(</span>REASON<span class="o">)</span>
          79265_65      <span class="nb">test</span> Simple H  foo      PD      <span class="m">0</span>:00      <span class="m">1</span> <span class="o">(</span>QOSMaxCpuPerUserLimit<span class="o">)</span>
          79265_67      <span class="nb">test</span> Simple H  foo      PD      <span class="m">0</span>:00      <span class="m">1</span> <span class="o">(</span>QOSMaxCpuPerUserLimit<span class="o">)</span>
          79265_69      <span class="nb">test</span> Simple H  foo      PD      <span class="m">0</span>:00      <span class="m">1</span> <span class="o">(</span>QOSMaxCpuPerUserLimit<span class="o">)</span>
          79265_97      <span class="nb">test</span> Simple H  foo      PD      <span class="m">0</span>:00      <span class="m">1</span> <span class="o">(</span>QOSMaxCpuPerUserLimit<span class="o">)</span>
          79265_57      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:47      <span class="m">1</span> fnode03
          79265_59      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:47      <span class="m">1</span> fnode03
          79265_61      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:47      <span class="m">1</span> fnode03
          79265_63      <span class="nb">test</span> Simple H  foo      R       <span class="m">0</span>:47      <span class="m">1</span> fnode03
</code></pre></div>

<h2 id="examples">Examples</h2>
<h3 id="use-case-1-1000-computations-same-resource-requirements-different-inputoutput-arguments">Use case 1: 1000 computations, same resource requirements, different input/output arguments</h3>
<p>Instead of submitting 1000 individual jobs, submit a single array jobs with 1000 tasks:</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --mail-type=NONE</span>
<span class="c1">#SBATCH --partition=all</span>
<span class="c1">#SBATCH --time=00:30:00     # Each task takes max 30 minutes</span>
<span class="c1">#SBATCH --mem-per-cpu=2G    # Each task uses max 2G of memory</span>
<span class="c1">#SBATCH --array=1-1000      # Submit 1000 tasks with task ID 1,2,...,1000.</span>
<span class="c1">#SBATCH --output=/dev/null</span>
<span class="c1">#SBATCH --error=/dev/null</span>

<span class="c1"># The name of the input files must reflect the task ID!</span>
./foo input_data_<span class="si">${</span><span class="nv">SLURM_ARRAY_TASK_ID</span><span class="si">}</span>.txt &gt; output_<span class="si">${</span><span class="nv">SLURM_ARRAY_TASK_ID</span><span class="si">}</span>.txt
</code></pre></div>

<div class="admonition types note">
<p>Task with ID 20 will run the program foo with the following arguments:<br />
./foo input_data_20.txt &gt; output_20.txt</p>
</div>
<h3 id="use-case-2-read-arguments-from-file">Use case 2: Read arguments from file</h3>
<p>Submit an array job with 1000 tasks. Each task executes the program foo with different arguments:</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1">#SBATCH --mail-type=NONE</span>
<span class="c1">#SBATCH --partition=all</span>
<span class="c1">#SBATCH --time=00:30:00    # Each task takes max 30 minutes</span>
<span class="c1">#SBATCH --mem-per-cpu=2G   # Each task uses max 2G of memory</span>
<span class="c1">#SBATCH --array=1-1000%20  # Submit 1000 tasks with task ID 1,2,...,1000. Run max 20 tasks concurrently</span>
<span class="c1">#SBATCH --output=/dev/null</span>
<span class="c1">#SBATCH --error=/dev/null</span>


<span class="nv">param_store</span><span class="o">=</span><span class="nv">$HOME</span>/projects/example/args.txt     <span class="c1"># args.txt contains 1000 lines with 2 arguments per line.</span>
                                                  <span class="c1"># Line &lt;i&gt; contains arguments for run &lt;i&gt;</span>
<span class="nv">data_dir</span><span class="o">=</span><span class="nv">$HOME</span>/projects/example/input_data        <span class="c1"># Input files are named input_run_0001.txt,...input_run_1000.txt</span>
<span class="nv">result_dir</span><span class="o">=</span><span class="nv">$HOME</span>/projects/example/results


<span class="nv">param_a</span><span class="o">=</span><span class="k">$(</span>cat <span class="nv">$param_store</span> <span class="p">|</span> awk -v <span class="nv">var</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span> <span class="s1">&#39;NR==var {print $1}&#39;</span><span class="k">)</span>    <span class="c1"># Get first argument</span>
<span class="nv">param_b</span><span class="o">=</span><span class="k">$(</span>cat <span class="nv">$param_store</span> <span class="p">|</span> awk -v <span class="nv">var</span><span class="o">=</span><span class="nv">$SLURM_ARRAY_TASK_ID</span> <span class="s1">&#39;NR==var {print $2}&#39;</span><span class="k">)</span>    <span class="c1"># Get second argument</span>


<span class="nv">n</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;%04d&quot;</span> <span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="k">)</span>    <span class="c1"># Zero pad the task ID to match the numbering of the input files</span>


./foo -c <span class="nv">$param_a</span> -p <span class="nv">$param_b</span> -i <span class="si">${</span><span class="nv">data_dir</span><span class="si">}</span>/input_run_<span class="si">${</span><span class="nv">n</span><span class="si">}</span>.txt -o <span class="si">${</span><span class="nv">result_dir</span><span class="si">}</span>/result_run_<span class="si">${</span><span class="nv">n</span><span class="si">}</span>.txt
<span class="nb">exit</span>
</code></pre></div>

<p><em><em>Related  pages:</em></em></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="deleting-jobs.html" title="Deleting Jobs" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Deleting Jobs
              </span>
            </div>
          </a>
        
        
          <a href="gpus.html" title="GPUs" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GPUs
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; University of Bern, IT Service Office
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/ubelix" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
    
  </body>
</html>